# 頻率與商品支援矩陣

## 腳本類型 × 頻率支援

| 頻率 | 指標 | 交易 | 選股 | 警示 |
|------|------|------|------|------|
| Tick | O | O | X | O |
| 1~240 分 | O | O | X | O |
| 日 K | O | O | O | O |
| 週 K | O | O | O | O |
| 月 K | O | O | O | O |
| 季/半年/年 K | O | X | O | O |

- 選股腳本**僅支援日 K 以上**頻率
- 交易腳本**不支援季 K 以上**頻率

## 商品類型 × 資料支援

| 資料類別 | 台股 | 美股 | 港陸股 | 期貨選擇權 | 大盤類股 |
|----------|------|------|--------|------------|----------|
| 價量 OHLCV | O | O | O | O | O |
| 技術指標 | O | O | O | O | O |
| 籌碼面 | **O** | X | X | X | X |
| 基本面 | O | O | 部分 | X | X |
| 事件 | **O** | X | X | X | X |
| 選擇權 Greeks | X | X | X | **O** | X |
| 大盤統計 | X | X | X | X | **O** |

## 靜默失敗警告

**XQ 不會報錯**——不支援的組合會**靜默回傳 0**。

```xs
// 美股取籌碼 → 靜默回傳 0，不會報錯！
value1 = GetField("外資買賣超(張)");  // 在美股上 = 0

// 期貨取本益比 → 靜默回傳 0
value2 = GetField("本益比");  // 在期貨上 = 0
```

這會導致**邏輯錯誤但不易發現**，必須在撰寫前確認商品支援。

## 關鍵限制摘要

| 限制 | 說明 |
|------|------|
| 籌碼資料 | **僅台股**個股可用 |
| 事件資料 | **僅台股**可用 |
| Greeks | **僅衍生性商品**（選擇權）可用 |
| 大盤統計 | **僅指數類**可用 |
| 月營收 | **僅台股**可用，美股無此欄位 |
| 融資融券 | **僅台股**可用 |

## 範例：安全取值模式

```xs
// 用 Default 參數避免 0 值誤判
value1 = GetField("外資買賣超(張)", "D", Default:=-99999);
if value1 <> -99999 then begin
    // 確實有資料，安全使用
    plot1(value1, "外資買超");
end;
```
