# 撰寫前可行性檢查程序

在撰寫任何 XS 腳本之前，**必須**依序完成以下三步驟檢查。

## Step 1：檢查腳本類型限制

確認需求所需的功能是否與腳本類型相容：

| 需求功能 | 必須使用的腳本類型 |
|----------|-------------------|
| 畫線/指標圖 | 指標 |
| 下單/回測 | 交易 |
| 選股/排序 | 選股 |
| 即時通知 | 警示 |
| GetQuote 即時報價 | 警示 或 交易 |
| OutputField | 選股 |
| plot/PlotK | 指標 |
| setposition | 交易 |

**若需求混合多種功能，可能需要拆分成多個腳本。**

## Step 2：檢查頻率相容性

確認目標頻率是否被腳本類型支援：

```
選股腳本 → 僅日K以上（不支援分鐘/Tick）
交易腳本 → 不支援季K以上
指標/警示 → 大部分頻率皆可
```

若使用 GetField 跨頻率，確認目標頻率代碼正確。

## Step 3：檢查商品對欄位支援

逐一確認腳本中使用的每個欄位，在目標商品上是否有資料：

```
籌碼欄位（外資/投信/融資等） → 僅台股
事件欄位 → 僅台股
月營收相關 → 僅台股
Greeks（Delta/Gamma等） → 僅選擇權
大盤統計 → 僅指數
基本面 → 台股完整，美股部分，期貨無
```

## 判定與處理

### 可行 → 直接撰寫
所有檢查通過，開始撰寫腳本。

### 不可行 → 必須告知並建議替代方案

**絕對不能**硬寫不可行的腳本。必須：
1. 明確告知使用者哪個步驟不通過
2. 說明原因
3. 提供替代方案

### 常見替代方案

| 問題 | 替代方案 |
|------|---------|
| 選股需要即時報價 | 改用警示腳本篩選 |
| 選股需要分鐘K | 改用日K頻率 + 盤後選股 |
| 交易腳本需要季K | 改用 GetField 跨頻率取季K資料 |
| 美股需要籌碼 | 告知無法實現，建議改用技術面條件 |
| 指標需要下單 | 拆分為指標 + 交易兩個腳本 |

## 檢查範例

```
使用者需求：「用外資買超選美股」

Step 1: 選股腳本 → OK
Step 2: 日K → OK
Step 3: 外資買賣超(張) + 美股 → ✗ 不支援！

結論：不可行
建議：外資籌碼僅支援台股，美股無法使用此條件。
      可改用技術面指標（如成交量變化）替代。
```
